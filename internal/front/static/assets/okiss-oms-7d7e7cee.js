import"./vue-d82d38a0.js";import{H as He,e as wt,p as de,D as xt,h as Et,E as Z,B as It,J as Tt,b as we,a as Fe,M as Re,N as ie,Z as Bt,A as Ge}from"./okiss-utils-602c6998.js";import{_ as ue}from"./mockjs-dd17acb2.js";import{Z as Ct,l as f}from"./lodash-e851e67e.js";import{l as Je,i as Ot,E as Ke,a as $t,b as At,c as Pt,d as ze,e as Lt,f as Dt,g as xe,h as Rt,j as Ee,k as Ze,m as se,n as We,o as Xe,p as le,q as W,r as jt,s as Mt,t as Nt,u as Vt,v as qt,w as Ut,x as Ht,y as Ft,z as Gt,A as Ie,B as re,C as Jt}from"./element-plus-06cec8db.js";import{I as Te}from"./axios-2e20ef17.js";import{a as j}from"./js-cookie-edb2da2a.js";import{c as Kt,m as Be,u as Ye}from"./vuex-5d055800.js";import"./dayjs-f18a4a92.js";import{c as zt,a as Zt,u as Wt,b as pe,o as Xt,d as Yt}from"./vue-router-f0e82e03.js";import{c as Qt}from"./path-to-regexp-6c7b4327.js";import{Y as Ce,B as el,U as tl,q as G,a as Oe,b as te,r as ll}from"./okiss-vbtf-04481fae.js";/* empty css                      */import{O as al}from"./mitt-fa5ce9e6.js";import{i as il}from"./vueuse-core-fbf0da98.js";import{A as ol}from"./vue3-markdown-it-1ddd45d9.js";import{a as nl}from"./crypto-js-324edac3.js";import{k as ve}from"./nprogress-d0980f19.js";import{h as N,c as D,j as s,k as b,l as y,s as oe,F as E,I as $,f as Qe,p as sl,L as g,n as u,y as c,x as _,q as r,v as I,m as q,R as et,S as tt,r as ee,O as X,t as lt,o as rl,g as pl,K as cl,P as dl}from"./vue-runtime-core-ffab33f8.js";import{f as ul,e as me,a as ml,T as hl}from"./vue-runtime-dom-97cbdded.js";import{r as L,u as S,b as fl,i as bl,e as yl}from"./vue-reactivity-557f7d4b.js";import{n as U,t as O,f as vl,j as H}from"./vue-shared-138e5322.js";String.prototype.format||(String.prototype.format=function(){const e=arguments;return this.replace(/{(\d+)}/g,function(t,l){return typeof e[l]<"u"?e[l]:t})});const gl=N({__name:"App",setup(e){var t,l,i,a;return Qe(()=>{var o;const n=document.getElementById("preloader");n!==null&&(document.body.removeChild(n),(o=document.getElementById("preloader"))==null||o.remove(),It("test-icon","//at.alicdn.com/t/font_2246548_zclaqxwmzq8.css"),Tt(`.iconfont {
      font-size: 19px;
      font-style: normal;
      -webkit-font-smoothing: antialiased;
      font-family: iconfont !important;
    }`))}),(l=(t=window==null?void 0:window.OmsOptions)==null?void 0:t.form)!=null&&l.vsPath&&sl("vsPath",(a=(i=window==null?void 0:window.OmsOptions)==null?void 0:i.form)==null?void 0:a.vsPath),(o,n)=>{const d=g("router-view");return s(),u(d)}}});var Y=(e=>(e.GET="get",e.POST="post",e.DELETE="delete",e.FETCH="fetch",e.OPTION="option",e.PUT="put",e))(Y||{});const kl={saveApi:"/save",afterSubmit:"",afterReset:"goback",options:{column:3,submitButton:{text:"提交"},cancelButton:{text:"取消",on:{click:"() => console.error(33333333)"}}},formItems:[{type:"radio",field:"radio",label:"单选框",info:'表单控件支持提示信息, 可写html <a class="el-link el-link--primary is-underline" target="_blank" href="http://github.com/daodao97">文档</a>',options:[{value:1,label:"选项1"},{value:2,label:"选项2"}],value:1,col:{span:12}},{type:"input",field:"input",label:"输入框",value:5,props:{maxlength:10,suffixIcon:"el-icon-date",slots:{prepend:"前缀"},showCopy:!0,prefixIcon:"el-icon-search"},rules:[{required:!0,message:"该项为必填项"}],depend:{field:"radio",value:1},computed:[{when:"aaa",set:{checkbox:{value:[1]}}},{when:"bbb",set:{checkbox:{value:[2,3]}}}],info:"当前控件依赖 单选框 的值, 仅在 选项1 下显示",col:{span:12}},{type:"number",field:"number",label:"数字",props:{step:2},computed:{when:4,set:{range_number:{label:"数字区间2"}}},col:{span:12},value:4},{type:"number-range",field:"range_number",label:"数字区间",col:{span:12}},{type:"checkbox",field:"checkbox",label:"复选框",value:[],options:[{value:1,label:"复选框1"},{value:2,label:"复选框2"},{value:3,label:"复选框3"}],info:"动态计算, 当 输入框 字段的值 为 aaa 时, 复选框1将被选中, 为 bbb 时, 复选框2,3 将被选中",col:{span:8}},{type:"date",field:"date",label:"日期",props:{disabled:!0},info:"禁用控件",col:{span:8}},{type:"date",field:"date_range",label:"日期范围",value:"",props:{type:"daterange",rangeSeparator:"~",startPlaceholder:"开始日期",endPlaceholder:"结束日期"},col:{span:8}},{type:"time",field:"time",label:"时间"},{type:"time",field:"time_range",label:"时间范围",props:{isRange:!0}},{type:"datetime",field:"datetime",label:"日期时间"},{type:"datetime",field:"datetime_range",label:"日期时间范围",props:{type:"datetimerange"}},{type:"select",field:"select",label:"下拉框",options:[{value:1,label:"选项1"},{value:2,label:"选项2"},{value:3,label:"选项3"},{value:4,label:"选项4"}],props:{selectApi:"/user/select"}},{type:"switch",field:"switch",label:"开关"},{type:"slider",field:"slider",label:"滑块"},{type:"upload",field:"upload",label:"上传",value:"http://qupinapptest.oss-cn-beijing.aliyuncs.com/1/202002/d81d3c9dc7c3df7590d333f783a97995.jpeg",props:{}},{type:"upload",field:"upload_multiple",label:"上传多张",props:{limit:3}},{type:"transfer",field:"transfer",label:"穿梭框",options:[{value:1,label:"备选项1"},{value:2,label:"备选项2"},{value:3,label:"备选项3"}],value:[]},{type:"color",field:"color",label:"颜色"},{type:"rate",field:"rate",label:"评分",value:3},{type:"sub-form",field:"sub_form",label:"多项子表单",props:{repeat:!0,formItems:[{type:"input",field:"sub_input",label:"输入框",rules:[{required:!0,message:"子表单的校验将在上层表单校验通过后执行"}],info:"input 输入框支持 mask",props:{mask:"99-9999999"}},{type:"input",field:"sub_input_1",label:"输入框1"}]}},{type:"sub-form",field:"sub_form_not_repeat",label:"子表单",props:{options:{inline:!0},formItems:[{type:"input",field:"sub_input",label:"输入框",rules:[{required:!0,message:"子表单的校验将在上层表单校验通过后执行"}]},{type:"input",field:"sub_input_1",label:"输入框1"}]}},{type:"icon-select",field:"icon",label:"图标"},{type:"json",field:"json",label:"json",value:'{"a":1}'},{type:"rule",field:"rule",label:"rule",value:[],props:{factorOptions:[{label:"A",value:"A"},{label:"B",value:"B"},{label:"C",value:"C"}],symbolOptions:[{label:"大于",value:">"},{label:"等于",value:"="},{label:"小于",value:"<"}]}},{type:"template",field:"p3",label:"自定义",comp:{inject:["formData"],template:'<div>{{ msg }}<br/>当前的表单数据是:<pre>{{JSON.stringify(formData, null, 2)}}</pre><el-button @click="onclick">click</el-button></div>',data:{msg:"this is custom data"},methods:{onclick:"() => { console.log(this)}"}},info:"在通用表单控件无法满足需求时, 可以编写 `template` 模板组件"}]},je=[{type:"jump",text:"跳转",target:"http://github.com/daodao97"},{type:"api",text:"请求接口",target:"/test_api",extra:{method:"POST",url:"/test_api"},props:{type:"warning"}},{type:"table",text:"表格",extra:{infoApi:"/student/list_info",listApi:"/student/list"},props:{type:"info"}},[{type:"jump",text:"跳转",target:"http://github.com/daodao97"},{type:"api",text:"请求接口",extra:{method:"POST",url:"/test_api"}}],{type:"form",text:"表单",extra:{infoApi:"/form",saveApi:"/save"},props:{type:"success"}}],_l={exportAble:!0,filter:[{field:"name",type:"input",label:"姓名"},{field:"sex",type:"select",label:"性别",options:[{value:1,label:"男"},{value:0,label:"女"}]}],headers:[{field:"name",label:"姓名",info:"表头提示"},{field:"sex",type:"enum",label:"性别",options:[{value:1,label:"男"},{value:0,label:"女"}],state:{1:"info",0:"warning"},props:{sortable:!0}},{field:"github",type:"link",label:"主页"},{field:"html",type:"html",label:"HTML"},{field:"image",type:"image",label:"头像"},{field:"json",type:"json",label:"信息"},{field:"richText",type:"rich-text",label:"信息"}],batchButton:je,rowButton:[{type:"jump",text:"编辑",target:"/user/{id}"},{type:"form",extra:{infoApi:"/user/{id}",saveApi:"/user/{id}"},props:{icon:"el-icon-edit",type:"success"}},{type:"api",extra:{method:"POST",url:"/student/{id}"},props:{icon:"el-icon-delete",type:"danger"}}],normalButton:[...Ct.cloneDeep(je),{type:"jump",target:"/user/form",props:{icon:"el-icon-plus",type:"primary"}}],selectedNotice:"当前共勾选: {selectedCount} 条",listApi:"/user/list"},Sl={code:0,data:{"list|0-100":[{"id|0-1000":1,name:"@cname","sex|0-1":1,"score|0-100":60,link:"http://github.com/daodao97",image:"http://qupinapptest.oss-cn-beijing.aliyuncs.com/1/202002/d81d3c9dc7c3df7590d333f783a97995.jpeg",html:"<S>显示删除线1</S>",json:{slogan:"左手代码右手诗"},richText:"在一段文本中<突出|black|yellow>显示某些<文字|#ffffff|#000000>"}],page:{"count|1-10":2,"page|1-5":2}}},wl={afterSubmit:"",afterReset:"goback",formItems:[{type:"input",label:"span12-1",col:{span:12}},{type:"input",label:"span12-1",col:{span:12}},{type:"input",label:"span6-1",col:{span:6}},{type:"input",label:"span6-1",col:{span:6}},{type:"input",label:"span"}]},xl={afterSubmit:"",afterReset:"",formItems:[{type:"input",label:"span12-1",col:{span:12}},{type:"input",label:"span12-1",col:{span:12}},{type:"input",label:"span6-1",section:"表单片段1",col:{span:6}},{type:"input",label:"span6-1",col:{span:6}},{section:"表单片段2",type:"input",label:"span"}]},El={form:kl,table:_l,listMock:Sl,layoutForm:wl,layoutSection:xl},Il=[{method:Y.POST,url:"/login",response(e){return{code:0,data:{name:"daodao97",token:"xxxxxxx"}}}},{method:Y.GET,url:"/user/info",response(e){return{code:0,data:{role_ids:[1],resource:[[0,20,"formItems","radio"],[0,1,2]]}}}},{url:"/user/routes",method:Y.GET,response:e=>({code:0,data:[{id:0,label:"",routes:[]}]})},{url:"/user/list",method:Y.GET,response:e=>El.listMock}],Tl=[...Il],Bl={baseURL:"/api",withCredentials:!0,cacheEnable:!0},at={title:"oms",fixedHeader:!1,sidebarLogo:!0,logo:"http://assest.daodao.run/logo.png",closeNavNotice:!1,navBarNotice:"",hasNewMessage:!0,showPageJsonSchema:!1,loginTips:"",sso:{},ElementPlus:{size:"default",zIndex:3e3,locale:Je},nav:[],whiteRoutes:["/login"],tokenExpire:7*24*60*60*1e3,defaultAvatar:"http://assest.daodao.run/avatar.jpg",envColor:{uat:"gray",pre:"green"},serviceOffLineNotice:"当前页面功能正在维护, 请稍后再试~~~"},$e={axios:Bl,settings:at,plugins:[],mock:!1},ge={};function it(e){e.forEach(t=>{const l=ot(t);ge[`${t.method}::${l}`]=t})}it(Tl);function ot(e){var t;let l=e.url,i=e.baseURL||((t=$e.axios)==null?void 0:t.baseURL);return i||(i=""),typeof l=="string"?(l=("/"+i+l).split("/").filter(a=>a).join("/"),l+="(|\\?.*)$",new RegExp(l)):l}function Cl(){Object.keys(ge).forEach(e=>{const t=ge[e],l=ot(t);ue.mock(l,t.method,function(i){const{url:a,type:o,body:n}=i,d=xt(a),p=n?JSON.parse(n):{},m=t.response({query:d,data:p}),h=ue.mock(m);return Et(a,{type:o,query:d,data:p,response:h}),ue.mock(h)})}),console.log("%c ApiMock is stared! ","background: #606060; color: #fff; padding: 4px 5px; border-radius: 1px;")}const Ae="oms:token";function Pe(){return j.get(Ae)||""}function Ol(e){const t=new Date(new Date().getTime()+(w.state.settings.tokenExpire||864e5));return j.set(Ae,e,{expires:t})}function nt(){return j.remove(Ae)}const $l={name:"",nickname:"",avatar:"",token:Pe(),customRouter:[],remoteRouter:[],menuRoutes:[],isLodeRemoteRoutes:!1,resource:{},roleIds:[],path:"",env:""},Al={namespaced:!0,state:$l,mutations:{updateToken(e,t){e.token=t,Ol(t)},removeToken(e){e.token="",nt()},updateRemoteRouter(e,t){e.remoteRouter=t,e.isLodeRemoteRoutes=!0},setCustomRoutes(e,t){e.customRouter=e.customRouter.concat(t)},updateState(e,{key:t,value:l}){e[t]=l},resetUser(e){Object.assign({name:"",nickname:"",avatar:"",token:Pe(),customRouter:[],remoteRouter:[],menuRoutes:[],isLodeRemoteRoutes:!1,resource:{},roleIds:[],path:"",env:""})}},actions:{login({commit:e,state:t,rootState:l},i){return new Promise((a,o)=>{l.http?l.http.request({url:"/user/login",method:"POST",data:i}).then(n=>{var d;e("updateToken",(d=n.data)==null?void 0:d.token),a(!0)}).catch(n=>{o(n)}):o("http client not init")})},logout({commit:e}){e("removeToken"),e("resetUser")},info({commit:e,rootState:t}){return new Promise((l,i)=>{t.http?t.http.request({url:"/user/info",method:"GET"}).then(a=>{var o,n,d,p,m,h;const v=((o=a.data)==null?void 0:o.role_ids)||[];e("updateState",{key:"name",value:(n=a.data)==null?void 0:n.name}),e("updateState",{key:"nickname",value:(d=a.data)==null?void 0:d.nickname}),e("updateState",{key:"roleIds",value:v}),e("updateState",{key:"env",value:(p=a.data)==null?void 0:p.env});const k=((m=a.data)==null?void 0:m.website)||{};e("settings/updateSettings",k,{root:!0}),!j.get("username")&&j.set("username",(h=a.data)==null?void 0:h.name),l(!0)}).catch(a=>{i(a)}):i("http client not init")})},loadRemoteRoutes({state:e,rootState:t}){return new Promise((l,i)=>{var a;(a=t.http)==null||a.request({url:"/user/routes",method:"get"}).then(o=>{if(o.code===0){const n=o.data||[];l(n)}else i("error")}).catch(o=>{console.log(o),i(o)})})}}},Pl=f.cloneDeep(at),Ll={namespaced:!0,state:Pl,mutations:{updateSettings(e,t){e=f.merge(e,t)}},actions:{updateSettings({commit:e,state:t},l){e("updateSettings",l)}}},Dl={sidebar:{opened:j.get("sidebarStatus")?!!j.get("sidebarStatus"):!0,withoutAnimation:!1},device:"desktop",pages:{},currentRouteMeta:{},builderSchema:{},baseURL:""},Rl={namespaced:!0,state:Dl,mutations:{TOGGLE_SIDEBAR:e=>{e.sidebar.opened=!e.sidebar.opened,e.sidebar.withoutAnimation=!1,e.sidebar.opened?j.set("sidebarStatus","1"):j.set("sidebarStatus","0")},CLOSE_SIDEBAR:(e,t)=>{j.set("sidebarStatus","0"),e.sidebar.opened=!1,e.sidebar.withoutAnimation=t},TOGGLE_DEVICE:(e,t)=>{e.device=t},SET_PAGE_JSON_SCHEMA:(e,{page:t,json:l})=>{e.pages[t]=l},SET_CURRENT_META:(e,t)=>{e.currentRouteMeta=t},SET_BUILDER_SCHEMA:(e,t)=>{e.builderSchema=t},SET_BASE_API:(e,t)=>{e.baseURL=t}},actions:{toggleSideBar({commit:e}){e("TOGGLE_SIDEBAR")},closeSideBar({commit:e},{withoutAnimation:t}){e("CLOSE_SIDEBAR",t)},toggleDevice({commit:e},t){e("TOGGLE_DEVICE",t)},setPageJsonSchema({commit:e},t){e("SET_PAGE_JSON_SCHEMA",t)},setCurrentMeta({commit:e},t){e("SET_CURRENT_META",t)},setBuilderSchema({commit:e},t){e("SET_BUILDER_SCHEMA",t)},setBaseAPI({commit:e},t){e("SET_BASE_API",t)}}},jl={currentCellItem:{}},Ml={namespaced:!0,state:jl,mutations:{SET_CURRENT_CELLITEM:(e,t)=>{e.currentCellItem=t}},actions:{setCurrentCellItem({commit:e},t){e("SET_CURRENT_CELLITEM",t)}}},w=Kt({state:void 0,getters:{http:e=>e.http,sidebar:e=>e.app.sidebar,device:e=>e.app.device,token:e=>e.user.token,avatar:e=>e.user.avatar,name:e=>e.user.name,nickname:e=>e.user.nickname,remoteRouter:e=>e.user.remoteRouter,customRouter:e=>e.user.customRouter,nav:e=>e.settings.nav,builderSchema:e=>e.app.builderSchema,currentCellItem:e=>e.builderSchema.currentCellItem},mutations:{setHttp(e,t){e.http=t}},actions:{setHttp({commit:e,state:t},l){e("setHttp",l)}},modules:{user:Al,settings:Ll,app:Rl,builderSchema:Ml}}),Nl=Ke,Me=$t,Vl=Te.CancelToken,ne={taskList:{},cacheList:new Map,uniqueId(e){return`${location.href}|${e.method}|${e.url}|`},addTask(e,t){const l=this.uniqueId(e);this.taskList[l]=t},delTask(e){const t=this.uniqueId(e),l=this.taskList[t];l&&l(e)},pending(e){const t=this.uniqueId(e);return!!this.taskList[t]},cache(e){const t=this.uniqueId(e),l=this.cacheList.get(t);if(l){if(l.expirationTime<new Date().getTime()){this.delCache(e);return}return console.log("getcache",t,l.response),l.response}},addCache(e,t){const l=this.uniqueId(e),i=e.cacheTime||0;i&&this.cacheList.set(l,{response:t,expirationTime:new Date().getTime()+i})},delCache(e){const t=this.uniqueId(e);return this.cacheList.delete(t)}},ql={onFulfilled:function(e){return e.cacheEnable===!1||(ne.pending(e)&&ne.delTask(e),e.cancelToken=new Vl(t=>{ne.addTask(e,t)})),e},onRejected(e){return Promise.reject(e)}},Ul={onFulfilled:function(e){return e.config.cacheEnable===!1||e.config.method==="get"&&Object.keys(e.data).length>0&&ne.addCache(e.config,e.data),e},onRejected(e){return Promise.reject(e)}},st={};function Pn(e,t){st[e]=t}function Hl(e){return st[e]}const Fl=N({name:"Dashboard",setup(){const e=Ye(),t=Hl("dashboard");if(t)return()=>c("span",null,[c(t,null,null)]);const l=D(()=>e.getters.name);return()=>c("div",{class:"dashboard-container"},[c("div",{class:"dashboard-text"},[_("Hi "),l.value,_(" 😄")])])}}),T=(e,t)=>{const l=e.__vccOpts||e;for(const[i,a]of t)l[i]=a;return l},Gl=T(Fl,[["__scopeId","data-v-3122b6c7"]]),Jl={data(){return{levelList:null}},watch:{$route(){this.getBreadcrumb()}},created(){this.getBreadcrumb()},methods:{getBreadcrumb(){let e=this.$route.matched.filter(l=>l.meta&&l.meta.title);const t=e[0];this.isDashboard(t)||(e=[{path:"/dashboard",meta:{title:"Dashboard"}}].concat(e)),this.levelList=e.filter(l=>l.meta&&l.meta.title&&l.meta.breadcrumb!==!1)},isDashboard(e){const t=e&&e.name;return t?t.trim().toLocaleLowerCase()==="Dashboard".toLocaleLowerCase():!1},pathCompile(e){const{params:t}=this.$route;return Qt(e)(t)},handleLink(e){const{redirect:t,path:l}=e;if(t){this.$router.push(t);return}this.$router.push(this.pathCompile(l))}}},Kl={key:0,class:"no-redirect"},zl=["onClick"];function Zl(e,t,l,i,a,o){const n=At,d=Pt;return s(),u(d,{class:"app-breadcrumb",separator:"/"},{default:r(()=>[c(ml,{name:"breadcrumb"},{default:r(()=>[(s(!0),b(E,null,$(a.levelList,(p,m)=>(s(),u(n,{key:p.path},{default:r(()=>[p.path.indexOf("/DIR_")===0&&p.redirect===void 0||m===a.levelList.length-1?(s(),b("span",Kl,O(p.meta.title),1)):(s(),b("a",{key:1,onClick:h=>o.handleLink(p)},O(p.meta.title),9,zl))]),_:2},1024))),128))]),_:1})]),_:1})}const Wl=T(Jl,[["render",Zl],["__scopeId","data-v-fa74804e"]]),Xl={name:"Hamburger",props:{isActive:{type:Boolean,default:!1}},emits:["toggle-click"],methods:{toggleClick(){this.$emit("toggle-click")}}};function Yl(e,t,l,i,a,o){const n=g("v-icon");return s(),b("div",{style:{padding:"0 15px"},onClick:t[0]||(t[0]=(...d)=>o.toggleClick&&o.toggleClick(...d))},[c(n,{class:U({"is-active":l.isActive}),name:"ra-leftalignment"},null,8,["class"])])}const Ql=T(Xl,[["render",Yl]]),ea={};function ta(e,t){const l=W,i=Ht,a=Ft,o=Gt;return s(),u(o,{style:{width:"100%",height:"100%"}},{default:r(()=>[c(l,{class:"aside"},{default:r(()=>[ee(e.$slots,"left-aside",{},void 0,!0)]),_:3}),c(i,{class:"main",style:{margin:"0 10px"}},{default:r(()=>[ee(e.$slots,"main",{},void 0,!0)]),_:3}),c(a,{class:"aside",width:"350px",style:{padding:"20px"}},{default:r(()=>[ee(e.$slots,"right-aside",{},void 0,!0)]),_:3})]),_:3})}const rt=T(ea,[["render",ta],["__scopeId","data-v-7c3d697b"]]),la={type:"input",name:"文本框",default:{type:"input",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"sub-form",field:"props",label:"属性",props:{options:{labelPosition:"top"},formItems:[{type:"number",field:"maxlength",label:"最大字符数"},{type:"icon-select",field:"prefixIcon",label:"前置ICON"},{type:"icon-select",field:"suffixIcon",label:"后置ICON"},{type:"switch",field:"showCopy",label:"复制"},{type:"switch",field:"disabled",label:"禁用"},{type:"switch",field:"showWordLimit",label:"显示限制词数"},{type:"input",field:"mask",label:"mask",info:'<a href="https://github.com/RobinHerbots/Inputmask" target="_blank" class="el-link el-link--primary">文档</a>'}]}}]},aa={type:"number",name:"数字",default:{type:"number",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"sub-form",field:"props",label:"属性",props:{options:{labelPosition:"top"},formItems:[{type:"number",field:"min",label:"最小值"},{type:"number",field:"man",label:"最大值"}]}}]},ia={type:"number-range",name:"数字区间",default:{type:"number-range",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"sub-form",field:"props",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"unit",label:"单位"},{type:"switch",field:"disabled",label:"禁用"}]}}]},oa={type:"select",name:"下拉框",default:{type:"select",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"radio",field:"optionType",label:"备选项类型",value:0,options:[{value:0,label:"local"},{value:1,label:"remote"}]},{type:"sub-form",field:"options",label:"备选项",props:{repeat:!0,options:{labelPosition:"top"},formItems:[{type:"input",field:"value",label:"value"},{type:"input",field:"label",label:"label"}]},depend:{field:"optionType",value:0}},{type:"sub-form",field:"props",label:"属性",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"selectApi",label:"备选项接口",depend:{field:".optionType",value:1}},{type:"switch",field:"multiple",label:"多选"},{type:"number",field:"multipleLimit",label:"最大选中数",depend:{field:"multiple",value:!0}},{type:"switch",field:"allowCreate",label:"允许创建"},{type:"switch",field:"filterable",label:"允许过滤"}]}}],trans(e){const t=f.cloneDeep(e);return e.optionType===0?t.props&&t.props.selectApi!==void 0&&delete t.props.selectApi:e.optionType===1&&t.options&&delete t.options,delete t.optionType,t}},na={type:"radio",name:"单选框",default:{type:"radio",label:"label",field:"field_name",options:[]},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"sub-form",field:"options",label:"备选项",props:{formItems:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"value",label:"字段值"}],repeat:!0}},{type:"input",field:"default",label:"默认值"}]},sa={type:"switch",name:"开关",default:{type:"switch",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"sub-form",field:"props",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"activeText",label:"打开时的文字描述"},{type:"input",field:"inactiveText",label:"关闭时的文字描述"},{type:"color",field:"activeColor",label:"打开时的背景色"},{type:"color",field:"inactiveColor",label:"关闭时的背景色"},{type:"switch",field:"disabled",label:"禁用"}]}}]},ra={type:"code",name:"Code",default:{type:"code",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"}]},pa={type:"json",name:"json",default:{type:"json",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"}]},ca={type:"upload",name:"上传",default:{type:"upload",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"}]},da={type:"template",name:"自定义组件",default:{type:"template",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"}]},ua={type:"icon-select",name:"图标选择器",default:{type:"icon-select",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"}]},ma={type:"sub-form",name:"子表单",default:{type:"sub-form",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"sub-form",field:"props",label:"属性",props:{options:{labelPosition:"top"},formItems:[{type:"switch",field:"repeat",label:"可重复"},{type:"sub-form",field:"form-items",label:"子表单控件",props:{options:{labelPosition:"top"},repeat:!0,formItems:[{type:"input",field:"label",label:"label"},{type:"select",field:"type",label:"类型",options:[{value:"input",label:"文本框"}]}]}},{type:"switch",field:"disabled",label:"禁用"}]}}]},ha={type:"checkbox",name:"复选框",default:{type:"checkbox",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"sub-form",field:"props",props:{options:{labelPosition:"top"},formItems:[{type:"number",field:"max",label:"最大选中数"},{type:"number",field:"min",label:"最小选中数"},{type:"switch",field:"disabled",label:"禁用"}]}}]},pt={};function A(e){pt[e.type]=e}A(la);A(oa);A(aa);A(ia);A(sa);A(ma);A(na);A(ha);A(ra);A(pa);A(ca);A(ua);A(da);const ke=pt,fa={options:{labelPosition:"top",submitButton:!1,cancelButton:!1},formItems:[{type:"input",field:"saveApi",label:"保存接口"},{type:"switch",field:"inline",label:"行布局"},{type:"radio",field:"labelPosition",label:"label位置",options:[{value:"right",label:"右"},{value:"left",label:"左"},{value:"top",label:"上"}]},{type:"input",field:"labelWidth",label:"label宽度",value:"100px"},{type:"switch",field:"showSubmitButton",label:"显示提交按钮",value:!0},{type:"sub-form",field:"submitButton",label:"提交按钮",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"text",label:"文案",value:"提交"},{type:"select",field:"type",label:"按钮类型",options:[{value:"primary",label:"primary"}]}]}},{type:"switch",field:"showCancelButton",label:"显示取消按钮",value:!0},{type:"sub-form",field:"cancelButton",label:"取消按钮",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"text",label:"文案",value:"取消"},{type:"select",field:"type",label:"按钮类型",options:[{value:"primary",label:"primary"}]}]}}]},he={labelPosition:"top",submitButton:!1,cancelButton:!1},Le=[];Object.keys(ke).forEach(e=>{Le.push({value:e,label:ke[e].name})});const ba={options:{submitButton:!1,cancelButton:!1},formItems:[{type:"sub-form",field:"columns",props:{repeat:!0,formItems:[{type:"input",field:"field",label:"字段key"},{type:"select",field:"type",label:"类型",options:f.cloneDeep(Le)},{type:"input",field:"label",label:"字段label"}]}}]},ya={components:{DevLayout:rt,VForm:G,VButton:Ce,JsonView:Oe},props:{schema:{type:Object,default:e=>{}}},data(){return{sqlOptions:{},sqlSchema:ba,baseSchema:fa,activeTab:"base",builderSchema:Object.assign({},this.$props.schema,{options:{submitButton:!1,cancelButton:!1}}),baseOptions:{},key:0,ctrlKey:0,activeCtrl:void 0,ctrlOptions:{},ctrlSchema:{},ctrlName:"",activeIndex:void 0,ctrlMap:ke,activeIndexReg:/(formItems)?\[(\d+)\]/,tableStruct:"",activeName:"1",currentCtrlType:"input",types:f.cloneDeep(Le)}},computed:{getSaveSchema(){return{formItems:this.builderSchema.formItems}}},watch:{baseOptions:{deep:!0,immediate:!0,handler(e){const t=f.cloneDeep(e);e.showSubmitButton===!1&&(t.submitButton=!1),e.cancelSubmitButton===!1&&(t.cancelButton=!1),delete t.showSubmitButton,delete t.showCancelButton,Object.keys(t).length>0&&(this.builderSchema=f.merge(this.builderSchema,{options:t}),this.key++)}},ctrlOptions:{deep:!0,handler(e){const t=f.get(this.builderSchema,this.activeIndex);if(!t)return;const l=t?t.type:"",i=this.ctrlMap[l],a=i.trans?i.trans(e):e;if(a&&Object.keys(a).length>0){if(a.type=l,this.activeIndex.indexOf("[")>-1){const[o,n,d]=this.activeIndex.match(/(\w+)\[(\d+)\]/);this.builderSchema[n][d]={...a}}else this.builderSchema[this.activeIndex]=a;this.key++}}},currentCtrlType:{handler(e){const t=this.ctrlMap[e];this.ctrlSchema=f.cloneDeep({options:f.cloneDeep(he),formItems:f.cloneDeep(t.builder)});const l=f.get(this.builderSchema,this.activeIndex);this.ctrlOptions=f.cloneDeep(l),this.ctrlOptions.type=e,this.ctrlKey++,this.key++}}},beforeCreate(){K.on("dev-action",({event:e,data:t})=>{this.onDevAction(t.type,t.devId)})},unmounted(){K.off("dev-action")},methods:{onDevAction(e,t){this.activeIndex="formItems"+t,e==="edit"&&(this.activeTab="ctrl",this.clicklabel()),e==="del"&&(this.activeTab="base",this.removeOne()),this.ctrlKey++},push(e){const t="formItems";this.ctrlOptions={},this.builderSchema[t]=this.builderSchema[t]||[];const l=this.ctrlMap[e];this.activeCtrl=l,this.builderSchema[t].push(f.cloneDeep(l.default)),this.ctrlSchema=f.cloneDeep({options:f.cloneDeep(he),formItems:f.cloneDeep(l.builder)}),this.ctrlKey++,this.key++,this.activeIndex=`${t}[${this.builderSchema[t].length-1}]`,this.activeTab="ctrl"},removeOne(){f.unset(this.builderSchema,this.activeIndex),this.builderSchema=f.cloneDeep(Fe(this.builderSchema)),this.activeIndex="",this.ctrlOptions={},this.ctrlSchema={},this.key++,this.ctrlKey++},clicklabel(){const e=this.activeIndex;if(e.match(this.activeIndexReg)){const t=f.cloneDeep(f.get(this.builderSchema,e)),l=t.type,i=this.ctrlMap[l];if(!i){this.$message({type:"warning",message:"尚未支持该组件的UI编辑"});return}this.currentCtrlType=l,this.ctrlOptions=t,this.ctrlSchema=f.cloneDeep({options:f.cloneDeep(he),formItems:f.cloneDeep(i.builder)}),this.ctrlKey++}},saveSchema(){this.$http.request({method:"POST",url:"/devtool/page_schema",data:{formItems:this.builderSchema.formItems}}).then(({data:e})=>{e&&this.$message({type:"success",message:"保存成功, 请刷新页面查看效果"})})}}};function va(e,t,l,i,a,o){const n=g("v-form"),d=Ze,p=se,m=g("JsonView"),h=g("VButton"),v=xe,k=Ee,x=We,F=Xe,V=g("dev-layout");return s(),u(V,null,{main:r(()=>[a.builderSchema.formItems?(s(),u(n,q({ref:"form",key:a.key,dev:!0},a.builderSchema),null,16)):I("",!0),c(d),c(p,{type:"primary",onClick:o.saveSchema},{default:r(()=>[_("保存页面配置")]),_:1},8,["onClick"]),_("    "),c(h,{text:"PageSchema",type:"modal"},{default:r(()=>[c(m,{data:o.getSaveSchema},null,8,["data"])]),_:1})]),"right-aside":r(()=>[a.activeIndex?(s(),u(F,{key:0},{default:r(()=>[c(x,{label:"控件类型"},{default:r(()=>[c(k,{modelValue:a.currentCtrlType,"onUpdate:modelValue":t[0]||(t[0]=C=>a.currentCtrlType=C)},{default:r(()=>[(s(!0),b(E,null,$(a.types,(C,z)=>(s(),u(v,{key:z,label:C.label,value:C.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):I("",!0),(s(),u(n,q({key:a.ctrlKey,modelValue:a.ctrlOptions,"onUpdate:modelValue":t[1]||(t[1]=C=>a.ctrlOptions=C)},a.ctrlSchema),null,16,["modelValue"]))]),_:1})}const ga=T(ya,[["render",va],["__scopeId","data-v-875f0171"]]),ka={type:"input",name:"文本框",default:{type:"input",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"sub-form",field:"props",label:"属性",props:{options:{labelPosition:"top"},formItems:[{type:"number",field:"maxlength",label:"最大字符数"},{type:"switch",field:"showWordLimit",label:"显示限制词数"},{type:"input",field:"mask",label:"mask",info:'<a href="https://github.com/RobinHerbots/Inputmask" target="_blank" class="el-link el-link--primary">文档</a>'}]}}]},_a={type:"select",name:"下拉框",default:{type:"select",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"radio",field:"optionType",label:"备选项类型",value:0,options:[{value:0,label:"local"},{value:1,label:"remote"}]},{type:"sub-form",field:"options",label:"备选项",props:{repeat:!0,options:{labelPosition:"top"},formItems:[{type:"input",field:"value",label:"value"},{type:"input",field:"label",label:"label"}]},depend:{field:"optionType",value:0}},{type:"sub-form",field:"props",label:"属性",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"selectApi",label:"备选项接口",depend:{field:".optionType",value:1}},{type:"switch",field:"multiple",label:"多选"},{type:"number",field:"multipleLimit",label:"最大选中数",depend:{field:"multiple",value:!0}},{type:"switch",field:"filterable",label:"允许过滤"}]}}],trans(e){const t=f.cloneDeep(e);return e.optionType===0?t.props&&t.props.selectApi!==void 0&&delete t.props.selectApi:e.optionType===1&&t.options&&delete t.options,delete t.optionType,t}},Sa={type:"date",name:"日期",default:{type:"date",label:"时间",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"}]},Ne={options:{labelPosition:"top",submitButton:!1,cancelButton:!1},formItems:[{type:"switch",field:"showFilter",label:"搜索条件",value:!0},{type:"switch",field:"showPagination",label:"页码",value:!0},{type:"switch",field:"exportAble",label:"导出按钮"}]},fe={labelPosition:"top",submitButton:!1,cancelButton:!1},wa={type:"span",name:"文本",default:{type:"span",label:"表头",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"input",field:"info",label:"提示"},{type:"switch",field:"sortable",label:"排序"}]},xa={type:"enum",name:"标签",default:{type:"enum",label:"表头",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"input",field:"info",label:"提示"},{type:"sub-form",field:"options",label:"映射",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"value",label:"value"},{type:"input",field:"label",label:"label"}]},value:[]}],trans(e){return e.options=e.options||[],e.label||(e.label="表头"),e}},Ea={type:"html",name:"HTML",default:{type:"html",label:"表头",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"input",field:"info",label:"提示"}]},Ia={type:"icon",name:"图标",default:{type:"icon",label:"表头",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"input",field:"info",label:"提示"}]},Ta={type:"image",name:"图片",default:{type:"image",label:"表头",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"input",field:"info",label:"提示"}]},Ba={type:"json",name:"JSON",default:{type:"json",label:"表头",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"input",field:"info",label:"提示"}]},Ca={type:"link",name:"链接",default:{type:"link",label:"表头",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"input",field:"info",label:"提示"}]},Oa={type:"rich",name:"富文本",default:{type:"rich",label:"表头",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"input",field:"info",label:"提示"}]},$a={type:"tpl",name:"模板",default:{type:"tpl",label:"表头",field:"field_name"},builder:[{type:"input",field:"label",label:"字段名"},{type:"input",field:"field",label:"字段key"},{type:"input",field:"info",label:"提示"},{type:"input",field:"tpl",label:"模板",info:"例如 <code>姓名: {name} 年龄:{age}</code>"}]},Aa={span:wa,enum:xa,html:Ea,icon:Ia,image:Ta,json:Ba,link:Ca,rich:Oa,tpl:$a},Pa={type:"jump",name:"跳转",default:{type:"jump",target:"",text:"按钮"},builder:[{type:"input",field:"target",label:"跳转地址",info:"可以是本地路由, 也可以是url"},{type:"input",field:"text",label:"文案"},{type:"sub-form",field:"props",label:"属性",props:{options:{labelPosition:"top"},formItems:[{type:"icon-select",field:"icon",label:"图标"},{type:"select",field:"type",label:"类型",options:[{value:"primary",label:"primary"},{value:"info",label:"info"}]}]}}]},La={type:"api",name:"接口请求",default:{type:"api",target:"",text:"请求"},builder:[{type:"input",field:"target",label:"API地址",info:"此处填写接口path即可"},{type:"input",field:"text",label:"文案"},{type:"sub-form",field:"props",label:"属性",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"text",label:"文案"},{type:"icon-select",field:"icon",label:"图标"},{type:"select",field:"type",label:"类型",options:[{value:"primary",label:"primary"},{value:"info",label:"info"}]},{type:"input",field:"api",label:"API地址",info:"此处填写接口path即可"},{type:"select",field:"method",label:"请求类型",options:[{value:"GET",label:"GET"},{value:"POST",label:"POST"},{value:"DELETE",label:"DELETE"},{value:"PUT",label:"PUT"}]}]}}]},Da={type:"form",name:"弹框表单",default:{type:"form",target:"",text:"弹框表单"},builder:[{type:"input",field:"text",label:"文案"},{type:"radio",field:"container",label:"模式",options:[{value:"dialog",label:"模态框"},{value:"drawer",label:"抽屉"}],value:"dialog"},{type:"radio",field:"schema_type",label:"表单类型",options:[{value:0,label:"本地"},{value:1,label:"远程"}],value:1},{type:"input",field:"infoApi",label:"formSchema接口",depend:{field:"schema_type",value:1}},{type:"json",field:"form-items",label:"表单控件"},{type:"input",field:"saveApi",label:"保存接口"}]},Ra={type:"table",name:"弹框列表",default:{type:"form",target:"",text:"弹框表单"},builder:[{type:"input",field:"text",label:"文案"},{type:"radio",field:"container",label:"模式",options:[{value:"dialog",label:"模态框"},{value:"drawer",label:"抽屉"}],value:"dialog"},{type:"radio",field:"schema_type",label:"表单类型",options:[{value:0,label:"本地"},{value:1,label:"远程"}],value:1},{type:"input",field:"infoApi",label:"formSchema接口",depend:{field:"schema_type",value:1}},{type:"json",field:"form-items",label:"表单控件"},{type:"input",field:"saveApi",label:"保存接口"}]},ja={jump:Pa,api:La,form:Da,table:Ra},Ma={components:{JsonView:Oe,DevLayout:rt,VTable:te,VForm:G,VButton:Ce},props:{schema:{type:Object,default:e=>{}}},data(){const e=fl(this.$props.schema);return delete e.listApi,e.list=[{}],{baseSchema:Ne,activeTab:"base",builderSchema:Object.assign({},Ne,e),baseOptions:{},key:0,ctrlKey:0,activeCtrl:void 0,activeBrick:void 0,ctrlOptions:{},ctrlSchema:{},ctrlName:"",activeIndex:void 0,ctrlMap:{filter:{input:ka,select:_a,date:Sa},headers:Aa,buttons:ja},activeIndexReg:/(filter|headers|normalButton|batchButton|rowButton)?\[(\d+)\]/,currentCtrlType:"input"}},computed:{types(){const e=[],t=this.ctrlMap[this.activeBrick];return Object.keys(t).forEach(l=>{e.push({value:l,label:t[l].name})}),e},getSaveSchema(){return{filter:this.builderSchema.filter,headers:this.builderSchema.headers,rowButton:this.builderSchema.rowButton,normalButton:this.builderSchema.normalButton,batchButton:this.builderSchema.batchButton}},currentBuilderSchema(){return this.$store.state.app.builderSchema}},watch:{baseOptions:{deep:!0,immediate:!0,handler(e){this.builderSchema=f.merge(this.builderSchema,e),this.key++,this.updateBuilderSchema()}},ctrlOptions:{deep:!0,handler(e){const t=this.activeIndex.match(this.activeIndexReg);if(!t)return;let l=this.builderSchema[t[1]][parseInt(t[2])].type;t[1]==="headers"&&l===void 0&&(l="span");const i=this.ctrlMap[this.activeBrick][l];if(!i)return;const a=i.trans?i.trans(e):e;if(a&&Object.keys(a).length>0){if(a.type=l,this.activeIndex.indexOf("[")>-1){const[o,n,d]=this.activeIndex.match(/(\w+)\[(\d+)\]/);this.builderSchema[n][d]={...a}}else this.builderSchema[this.activeIndex]=a;this.key++}this.updateBuilderSchema()}},currentCtrlType:{handler(e){const t=this.ctrlMap[this.activeBrick][e];this.ctrlSchema=f.cloneDeep({options:f.cloneDeep(fe),formItems:f.cloneDeep(t.builder)});const l=f.get(this.builderSchema,this.activeIndex);l.type=e;const i=f.cloneDeep(l);this.ctrlOptions=i,i.text&&(this.ctrlOptions.text=i.text,this.ctrlOptions.props=i.props||{}),this.ctrlKey++,this.key++,this.updateBuilderSchema()}}},beforeCreate(){K.on("dev-action",({event:e,data:t})=>{this.onDevAction(t.type,t.devId)})},unmounted(){K.off("dev-action")},methods:{updateBuilderSchema(){this.$store.dispatch("app/setBuilderSchema",this.builderSchema)},onDevAction(e,t){this.activeIndex=t,e==="edit"&&(this.activeTab="ctrl",this.clicklabel()),e==="del"&&(this.activeTab="base",this.removeOne()),this.ctrlKey++},pushFilter(e){this.push(e,"filter","filter","filter")},pushHeaders(e){this.push(e,"headers","headers","headers")},pushNormalButton(e){this.push(e,"normalButton","buttons","buttons")},pushBatchButton(e){this.push(e,"batchButton","buttons","buttons")},pushRowButton(e){this.push(e,"rowButton","buttons","buttons")},push(e,t,l,i){const a=this.ctrlMap[l];if(!a[e]){this.$message({type:"warning",message:"尚未支持此组件的UI编辑"});return}this.activeCtrl=a[e],this.activeBrick=i,this.ctrlOptions={},this.builderSchema[t]=this.builderSchema[t]||[],this.builderSchema[t].push(f.cloneDeep(a[e].default)),this.ctrlSchema=f.cloneDeep({options:f.cloneDeep(fe),formItems:f.cloneDeep(a[e].builder)}),this.key++,this.ctrlKey++,this.activeIndex=`${t}[${this.builderSchema[t].length-1}]`,this.activeTab="ctrl"},removeOne(){f.unset(this.builderSchema,this.activeIndex),this.builderSchema=f.cloneDeep(Fe(this.builderSchema)),this.activeIndex="",this.ctrlOptions={},this.ctrlSchema={},this.key++,this.ctrlKey++},clicklabel(){const e=this.activeIndex,t=e.match(this.activeIndexReg);if(t){const l=f.cloneDeep(f.get(this.builderSchema,e));this.activeBrick=t[1],["normalButton","batchButton","rowButton"].indexOf(t[1])>-1&&(this.activeBrick="buttons");let i=this.builderSchema[t[1]][parseInt(t[2])].type;t[1]==="headers"&&i===void 0&&(i="span");const a=this.ctrlMap[this.activeBrick][i];if(!a){console.log(this.activeBrick,i,t),this.$message({type:"warning",message:"尚未支持此组件的UI编辑"});return}this.ctrlOptions=l,this.currentCtrlType=i,this.ctrlSchema=f.cloneDeep({options:f.cloneDeep(fe),formItems:f.cloneDeep(a.builder)}),this.ctrlKey++}},saveSchema(){const{filter:e,headers:t,rowButton:l,normalButton:i,batchButton:a}=this.currentBuilderSchema;this.$http.request({method:"POST",url:"/devtool/page_schema",data:{filter:e,headers:t,rowButton:l,normalButton:i,batchButton:a}}).then(({data:o})=>{o&&this.$message({type:"success",message:"保存成功, 请刷新页面查看效果"})})}}};function Na(e,t,l,i,a,o){const n=le,d=se,p=W,m=g("v-table"),h=Ze,v=se,k=g("JsonView"),x=g("VButton"),F=xe,V=Ee,C=We,z=Xe,_t=g("v-form"),St=g("dev-layout");return s(),u(St,null,{"left-aside":r(()=>[c(p,{style:{width:"200px"}},{default:r(()=>[c(p,null,{default:r(()=>[c(n,{class:"title","data-id":22222},{default:r(()=>[_("添加搜索条件")]),_:1}),c(n,{class:"ctrl"},{default:r(()=>[c(d,{class:"ctrl-btn",onClick:t[0]||(t[0]=B=>o.pushFilter("input"))},{default:r(()=>[_("文本框")]),_:1})]),_:1}),c(n,{class:"ctrl"},{default:r(()=>[c(d,{class:"ctrl-btn",onClick:t[1]||(t[1]=B=>o.pushFilter("select"))},{default:r(()=>[_("下拉框")]),_:1})]),_:1}),c(n,{class:"ctrl"},{default:r(()=>[c(d,{class:"ctrl-btn",onClick:t[2]||(t[2]=B=>o.pushFilter("date"))},{default:r(()=>[_("日期")]),_:1})]),_:1})]),_:1}),c(p,null,{default:r(()=>[c(n,{class:"title"},{default:r(()=>[_("添加列表项")]),_:1}),(s(!0),b(E,null,$(Object.keys(a.ctrlMap.headers),(B,M)=>(s(),u(n,{key:`column-${M}`,class:"ctrl"},{default:r(()=>[c(d,{class:"ctrl-btn",onClick:ce=>o.pushHeaders(a.ctrlMap.headers[B].type)},{default:r(()=>[_(O(a.ctrlMap.headers[B].name),1)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),c(p,null,{default:r(()=>[c(n,{class:"title"},{default:r(()=>[_("添加行按钮")]),_:1}),(s(!0),b(E,null,$(Object.keys(a.ctrlMap.buttons),(B,M)=>(s(),u(n,{key:`column-${M}`,class:"ctrl"},{default:r(()=>[c(d,{class:"ctrl-btn",onClick:ce=>o.pushRowButton(a.ctrlMap.buttons[B].type)},{default:r(()=>[_(O(a.ctrlMap.buttons[B].name),1)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),c(p,null,{default:r(()=>[c(n,{class:"title"},{default:r(()=>[_("添加常规按钮")]),_:1}),(s(!0),b(E,null,$(Object.keys(a.ctrlMap.buttons),(B,M)=>(s(),u(n,{key:`column-${M}`,class:"ctrl"},{default:r(()=>[c(d,{class:"ctrl-btn",onClick:ce=>o.pushNormalButton(a.ctrlMap.buttons[B].type)},{default:r(()=>[_(O(a.ctrlMap.buttons[B].name),1)]),_:2},1032,["onClick"])]),_:2},1024))),128)),c(n,{class:"ctrl"},{default:r(()=>[c(d,{class:"ctrl-btn"},{default:r(()=>[_("按钮组")]),_:1})]),_:1})]),_:1}),c(p,null,{default:r(()=>[c(n,{class:"title"},{default:r(()=>[_("添加批量按钮")]),_:1}),(s(!0),b(E,null,$(Object.keys(a.ctrlMap.buttons),(B,M)=>(s(),u(n,{key:`column-${M}`,class:"ctrl"},{default:r(()=>[c(d,{class:"ctrl-btn",onClick:ce=>o.pushBatchButton(a.ctrlMap.buttons[B].type)},{default:r(()=>[_(O(a.ctrlMap.buttons[B].name),1)]),_:2},1032,["onClick"])]),_:2},1024))),128)),c(n,{class:"ctrl"},{default:r(()=>[c(d,{class:"ctrl-btn"},{default:r(()=>[_("按钮组")]),_:1})]),_:1})]),_:1})]),_:1})]),main:r(()=>[(s(),u(m,q({ref:"table",key:a.key,dev:!0},a.builderSchema),null,16)),c(h),c(v,{type:"primary",onClick:o.saveSchema},{default:r(()=>[_("保存页面配置")]),_:1},8,["onClick"]),_("    "),c(x,{text:"PageSchema",type:"modal"},{default:r(()=>[c(k,{data:o.getSaveSchema},null,8,["data"])]),_:1})]),"right-aside":r(()=>[a.activeIndex?(s(),u(z,{key:0},{default:r(()=>[c(C,{label:"控件类型"},{default:r(()=>[c(V,{modelValue:a.currentCtrlType,"onUpdate:modelValue":t[3]||(t[3]=B=>a.currentCtrlType=B)},{default:r(()=>[(s(!0),b(E,null,$(o.types,(B,M)=>(s(),u(F,{key:M,label:B.label,value:B.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):I("",!0),(s(),u(_t,q({key:a.ctrlKey,modelValue:a.ctrlOptions,"onUpdate:modelValue":t[4]||(t[4]=B=>a.ctrlOptions=B)},a.ctrlSchema),null,16,["modelValue"]))]),_:1})}const Va=T(Ma,[["render",Na],["__scopeId","data-v-e5209cb7"]]),qa={name:"PageEditor",components:{FormBuilder:ga,TableBuilder:Va},setup(){const e=L(!1),t=L(1),l="rtl",i=pe(),a=D(()=>w.state.app.pages[i.path]);return{show:e,key:t,direction:l,pageSchema:a}}};function Ua(e,t,l,i,a,o){const n=g("VIcon"),d=g("form-builder"),p=g("table-builder"),m=ze;return s(),b(E,null,[c(n,{name:"ra-set",onClick:t[0]||(t[0]=h=>i.show=!i.show)}),c(m,{modelValue:i.show,"onUpdate:modelValue":t[1]||(t[1]=h=>i.show=h),title:"页面设计",class:"my-drawer",direction:i.direction,size:"90%","destroy-on-close":"","append-to-body":""},{default:r(()=>[i.pageSchema.formItems!==void 0?(s(),u(d,{key:0,schema:i.pageSchema},null,8,["schema"])):I("",!0),i.pageSchema.headers!==void 0?(s(),u(p,{key:1,schema:i.pageSchema},null,8,["schema"])):I("",!0)]),_:1},8,["modelValue","direction"])],64)}const Ha=T(qa,[["render",Ua]]),Fa={components:{Breadcrumb:Wl,Hamburger:Ql,VButton:Ce,PageEditor:Ha},data(){return{showExportPop:!1,modulesList:this.getSetting("system_module"),showJsonSchema:!1,json:"",key:0,defaultAvatar:this.getSetting("defaultAvatar")}},computed:{...Be(["sidebar","avatar","name","nickname","nav"]),hasNewMessage(){return this.$store.state.settings.hasNewMessage},moduleName(){return this.$store.state.app.moduleName},setting(){return this.$store.state.settings},user(){return this.$store.state.user},showPageJsonSchemaIcon(){return this.$store.state.settings.showPageJsonSchema||!1}},mounted(){He("el-submenu is-active");const e=this.getSetting("navBarNotice");e.length>0&&!this.getSetting("closeNavNotice")&&this.showNotice(e)&&this.$notify({title:"提示",message:e,dangerouslyUseHTMLString:!0,duration:0,onClose:this.closeNavBarNotice}),this.setting.envColor[this.user.env]&&wt({elRef:this.$refs.header.$el,waterMark:this.user.env,color:"skyblue",size:"20"})},methods:{toggleSideBar(){this.$store.dispatch("app/toggleSideBar")},async logout(){await this.$store.dispatch("user/logout"),location.reload(`${location.origin}/#/login?redirect=${this.$route.fullPath}`)},getSetting(e){return this.$store.state.settings[e]},async closeNavBarNotice(){await this.$store.commit("settings/updateSettings",{closeNavNotice:!0}),this.closeNotice(this.getSetting("navBarNotice"))},showPopover(){this.showExportPop=!0},showNotice(e){const t="dismiss:navbar_notice";return de.exist(t)?de.get(t)!==e:!0},closeNotice(e){const t="dismiss:navbar_notice";de.set(t,e)},gotoMenuEdit(){var e,t,l,i;(t=(e=this.$route)==null?void 0:e.meta)!=null&&t.pageId&&window.open(location.origin+location.pathname+"#/menu/"+((i=(l=this.$route)==null?void 0:l.meta)==null?void 0:i.pageId))}}},Ga={class:"right-content"},Ja={class:"right-item"},Ka={key:0,class:"right-item"},za={class:"right-item-button",style:{padding:"0"}},Za={class:"user-info"},Wa=["src"],Xa={class:"user-name"};function Ya(e,t,l,i,a,o){const n=g("hamburger"),d=g("breadcrumb"),p=le,m=g("VIcon"),h=g("PageEditor"),v=g("v-button"),k=jt,x=Mt,F=Nt,V=ze,C=W;return s(),u(C,{ref:"header",class:"navbar",style:vl({background:o.setting.envColor[o.user.env]})},{default:r(()=>[c(p,{span:16},{default:r(()=>[c(n,{"is-active":e.sidebar.opened,class:"hamburger-container",onToggleClick:o.toggleSideBar},null,8,["is-active","onToggleClick"]),c(d,{class:"breadcrumb-container"})]),_:1}),c(p,{span:8},{default:r(()=>[y("div",Ga,[y("div",Ja,[c(m,{name:"ra-code",onClick:o.gotoMenuEdit},null,8,["onClick"])]),o.showPageJsonSchemaIcon?(s(),b("div",Ka,[c(h)])):I("",!0),y("div",za,[c(v,{buttons:e.nav},null,8,["buttons"])]),c(F,{class:"right-item",trigger:"click"},{dropdown:r(()=>[c(x,{class:"user-dropdown"},{default:r(()=>[c(k,{icon:"oms-icon-index",onClick:t[0]||(t[0]=z=>e.$router.push("/"))},{default:r(()=>[_("首页")]),_:1}),c(k,{divided:"",icon:"el-icon-switch-button",onClick:o.logout},{default:r(()=>[_("退出登录")]),_:1},8,["onClick"])]),_:1})]),default:r(()=>[y("div",Za,[y("img",{src:e.avatar?e.avatar:a.defaultAvatar,class:"user-avatar",alt:"头像"},null,8,Wa),_(),y("span",Xa,O(e.nickname||e.name),1)])]),_:1})])]),_:1}),a.showJsonSchema?(s(),u(V,{key:0,"with-header":!1,size:"50%"})):I("",!0)]),_:1},8,["style"])}const Qa=T(Fa,[["render",Ya],["__scopeId","data-v-99b3c688"]]),ei={name:"SidebarLogo",props:{collapse:{type:Boolean,required:!0}},computed:{title(){return this.$store.state.settings.title},logo(){return this.$store.state.settings.logo}}},ti=e=>(et("data-v-49084925"),e=e(),tt(),e),li=["src"],ai={key:1,class:"sidebar-title"},ii=ti(()=>y("div",null,"系统",-1)),oi=["src"],ni={class:"sidebar-title"};function si(e,t,l,i,a,o){const n=g("router-link");return s(),b("div",{class:U(["sidebar-logo-container",{collapse:l.collapse}])},[c(hl,{name:"sidebarLogoFade"},{default:r(()=>[l.collapse?(s(),u(n,{key:"collapse",class:"sidebar-logo-link",to:"/"},{default:r(()=>[o.logo?(s(),b("img",{key:0,src:o.logo,class:"sidebar-logo"},null,8,li)):(s(),b("h1",ai,O(o.title),1)),ii]),_:1})):(s(),u(n,{key:"expand",class:"sidebar-logo-link",to:"/"},{default:r(()=>[o.logo?(s(),b("img",{key:0,src:o.logo,class:"sidebar-logo"},null,8,oi)):I("",!0),y("h1",ni,O(o.title),1)]),_:1}))]),_:1})],2)}const ri=T(ei,[["render",si],["__scopeId","data-v-49084925"]]),pi={props:{to:{type:String,required:!0},newTab:{type:Boolean,required:!1}},methods:{compType(e){return Re(e)||this.newTab?"a":"router-link"},linkProps(e){return Re(e)?{is:"a",href:e,target:"_blank",rel:"noopener"}:this.newTab?{is:"a",href:this.$router.resolve(e).href,target:"_blank",rel:"noopener"}:{is:"router-link",to:e}}}};function ci(e,t,l,i,a,o){return s(),u(lt(o.compType(l.to)),H(X(o.linkProps(l.to))),{default:r(()=>[ee(e.$slots,"default")]),_:3},16)}const di=T(pi,[["render",ci]]),ui={computed:{device(){return this.$store.state.app.device}},mounted(){this.fixBugIniOS()},methods:{fixBugIniOS(){const e=this.$refs.subMenu;if(e){const t=e.handleMouseleave;e.handleMouseleave=l=>{this.device!=="mobile"&&t(l)}}}}},mi={class:"menu-content"},hi=N({__name:"MenuContent",props:{meta:{type:Object,default:()=>({icon:"",title:""})}},setup(e){return(t,l)=>{const i=g("VIcon");return s(),b(E,null,[c(i,{name:e.meta.icon||"ra-all"},null,8,["name"]),y("span",mi,O(e.meta.title),1)],64)}}}),fi={name:"SidebarItem",components:{AppLink:di,MenuContent:hi},mixins:[ui],props:{item:{type:Object,required:!0},isNest:{type:Boolean,default:!1},to:{type:String,default:""}},methods:{getTo(e){try{return this.$router.resolve(e.redirect?e.redirect:e).fullPath}catch{return console.error("路由解析错误"),"/"}}}},bi={key:0,class:"menu-wrapper"};function yi(e,t,l,i,a,o){const n=g("menu-content"),d=Lt,p=g("app-link"),m=g("sidebar-item",!0),h=Dt;return l.item.hidden!==!1?(s(),b("div",bi,[l.item.meta&&l.item.meta.menuType===2?(s(),b(E,{key:0},[l.item.meta?(s(),u(p,{key:0,to:l.to,"new-tab":l.item.meta.newTab},{default:r(()=>[c(d,{index:l.to,class:U({"submenu-title-noDropdown":!l.isNest})},{default:r(()=>[c(n,{meta:l.item.meta},null,8,["meta"])]),_:1},8,["index","class"])]),_:1},8,["to","new-tab"])):I("",!0)],64)):l.item.meta&&l.item.meta.menuType===1?(s(),u(h,{key:1,ref:"subMenu",index:l.to,class:U({"submenu-title-noDropdown":!l.isNest})},{title:r(()=>[l.item.redirect&&l.item.redirect!=="#"?(s(),u(p,{key:0,to:l.to},{default:r(()=>[c(n,{meta:l.item.meta},null,8,["meta"])]),_:1},8,["to"])):(s(),u(n,{key:1,meta:l.item.meta},null,8,["meta"]))]),default:r(()=>[(s(!0),b(E,null,$(l.item.children,v=>(s(),u(m,{key:v.path,"is-nest":!0,item:v,to:o.getTo(v),class:"nest-menu"},null,8,["item","to"]))),128))]),_:1},8,["index","class"])):I("",!0)])):I("",!0)}const vi=T(fi,[["render",yi]]);function ct(e){return e.filter(t=>{var l;return((l=t.meta)==null?void 0:l.menuType)===0?!1:(t.children&&(t.children=ct(t.children),t.children.length===0&&delete t.children),!0)})}const gi={data(){return{selected:""}},computed:{...Be(["remoteRouter"]),filterRoutes(){let e=[];return this.remoteRouter.forEach(t=>{e=e.concat(f.cloneDeep(t.routes))}),ct(e)}},methods:{getJumpPath:function(e){let t=e;if(e.meta.menuType===1&&e.children.length>0){for(let l=0;l<e.children.length;l++)if(e.children[l].path.indexOf("/:")===-1){t=e.children[l];break}}return this.$router.resolve(t.redirect?t.redirect:t).fullPath},onselected:function(e){this.$router.push(e),this.selected=""}}};function ki(e,t,l,i,a,o){const n=xe,d=Rt,p=Ee;return s(),u(p,{modelValue:a.selected,"onUpdate:modelValue":t[0]||(t[0]=m=>a.selected=m),filterable:"",placeholder:"搜索菜单...",class:"search-menu",onChange:o.onselected},{default:r(()=>[(s(!0),b(E,null,$(o.filterRoutes,m=>(s(),b(E,{key:m.path},[m.children!==void 0?(s(),b(E,{key:0},[m.meta.menuType!==0?(s(),u(d,{key:m.path+"-",label:m.meta.title},{default:r(()=>[(s(!0),b(E,null,$(m.children,(h,v)=>(s(),b(E,{key:h.path},[m.meta.menuType!==0?(s(),u(n,{key:0,label:(v===m.children.length-1?"└─":"├─")+h.meta.title,value:o.getJumpPath(h)},null,8,["label","value"])):I("",!0)],64))),128))]),_:2},1032,["label"])):I("",!0)],64)):(s(),u(n,{key:1,label:""+m.meta.title,value:o.getJumpPath(m)},null,8,["label","value"]))],64))),128))]),_:1},8,["modelValue","onChange"])}const _i=T(gi,[["render",ki],["__scopeId","data-v-7a867c34"]]);var R=(e=>(e[e.custom=0]="custom",e[e.list=1]="list",e[e.form=2]="form",e[e.customSchema=3]="customSchema",e[e.localComp=4]="localComp",e[e.tree=5]="tree",e[e.report=6]="report",e[e.entity=7]="entity",e))(R||{}),P=(e=>(e[e.hidden=0]="hidden",e[e.dir=1]="dir",e[e.menu=2]="menu",e[e.page=3]="page",e))(P||{});const Si=N({components:{SidebarItem:vi,Logo:ri,SearchMenu:_i},computed:{...Be(["sidebar","remoteRouter","customRouter"]),routes(){let e=[];return this.$router.options.routes.concat(this.customRouter||[]).forEach(t=>{t.path==="/"?e=e.concat(t.children||[]):e.push(t)}),f.cloneDeep([{label:"",routes:e},...this.remoteRouter])},activeMenu(){const e=this.$route.matched;for(let t=e.length-1;t>=0;t--){const l=e[t];if(l.meta.menuType===P.menu)return this.showActive(),this.$router.resolve(l.redirect?l.redirect:l).fullPath}return""},showLogo(){return this.$store.state.settings.sidebarLogo},variables(){return{menuBg:"#304156",menuText:"#bfcbd9",menuActiveText:"#409EFF"}},isCollapse(){return!this.sidebar.opened}},mounted(){this.showActive()},methods:{showActive(){He("is-active",200)},filterRoute(e){return e.filter(t=>[P.dir,P.menu].indexOf(t.meta.menuType)!==-1).map(t=>(t=Object.assign({},t),t.children&&(t.children=this.filterRoute(t.children)),t))}}});function wi(e,t,l,i,a,o){const n=g("logo"),d=g("search-menu"),p=g("sidebar-item"),m=Vt,h=qt;return s(),b("div",{class:U({"has-logo":e.showLogo})},[e.showLogo?(s(),u(n,{key:0,collapse:e.isCollapse},null,8,["collapse"])):I("",!0),c(h,{"wrap-class":"scrollbar-wrapper"},{default:r(()=>[e.isCollapse?I("",!0):(s(),u(d,{key:0})),c(m,{"default-active":e.activeMenu,collapse:e.isCollapse,"background-color":e.variables.menuBg,"text-color":e.variables.menuText,"unique-opened":!1,"active-text-color":e.variables.menuActiveText,"collapse-transition":!1,mode:"vertical"},{default:r(()=>[(s(!0),b(E,null,$(e.routes,(v,k)=>(s(),b(E,{key:k+"-module"},[(s(!0),b(E,null,$(e.filterRoute(v.routes),x=>(s(),u(p,{key:x.path,item:x,to:e.$router.resolve(x.redirect?x.redirect:x).fullPath},null,8,["item","to"]))),128))],64))),128))]),_:1},8,["default-active","collapse","background-color","text-color","active-text-color"])]),_:1})],2)}const xi=T(Si,[["render",wi],["__scopeId","data-v-d252f828"]]),Ei={class:"app-main"},Ii={__name:"AppMain",setup(e){const t=pe(),l=[],i=L(0);return Xt(()=>{var a;(a=t.meta)!=null&&a.keepAlive&&l.indexOf(t.name)&&l.push(t.name),i.value++}),(a,o)=>{const n=g("router-view"),d=Ut;return s(),b("section",Ei,[(s(),u(n,{key:a.$route.fullPath+S(i)})),c(d,{bottom:50})])}}},Ti=T(Ii,[["__scopeId","data-v-ca0f0d98"]]),Bi={class:"main-container"},Ci=992,Oi={__name:"index",setup(e){const t=Ye(),{body:l}=document,i=D(()=>t.state.app.sidebar),a=D(()=>t.state.app.device),o=D(()=>t.state.settings.fixedHeader),n=D(()=>({hideSidebar:!i.value.opened,openSidebar:i.value.opened,withoutAnimation:i.value.withoutAnimation,mobile:a.value==="mobile"})),d=()=>l.getBoundingClientRect().width-1<Ci;il(window,"resize",()=>m());const p=()=>{t.dispatch("app/closeSideBar",{withoutAnimation:!1})},m=()=>{if(!document.hidden){const h=d();t.dispatch("app/toggleDevice",h?"mobile":"desktop"),h&&t.dispatch("app/closeSideBar",{withoutAnimation:!0})}};return(h,v)=>(s(),b("div",{class:U([S(n),"app-wrapper"])},[S(a)==="mobile"&&S(i).opened?(s(),b("div",{key:0,class:"drawer-bg",onClick:p})):I("",!0),c(S(xi),{class:"sidebar-container"}),y("div",Bi,[y("div",{class:U({"fixed-header":S(o)})},[c(S(Qa))],2),c(S(Ti))])],2))}},dt=T(Oi,[["__scopeId","data-v-957442cd"]]),$i={};function Ai(){return f.merge(w.state.settings.sso||{},$i)}function Pi(){const e=Ai(),t=w.state.settings.activeSsoKey||"";console.log(e,t);const l=e[t];if(l!==void 0)return l()}const Li={id:"login"},Di=y("h1",{id:"title"},"登录",-1),Ri={id:"form"},ji={class:"captcha"},Mi=["src"],Ni={class:"tips"},Vi={class:"sso"},qi=y("div",{id:"sso-qrcode"},null,-1),Ui=N({__name:"login",setup(e){const t=Wt(),l=pe(),i=D(()=>w.state.settings.loginTips),a=D(()=>(console.log(w.state.app),w.state.app.baseURL)),o=L(0),n=()=>o.value++,d=D(()=>p.value.username.length>0&&p.value.password.length>=4&&p.value.captcha.length===4),p=L({username:"",password:"",captcha:"",sing:""}),m=()=>{if(p.value.username===""||p.value.password===""||p.value.captcha===""){Ke.error("用户名, 密码, 验证码是必须的");return}p.value.sing=nl.MD5(`${p.value.username}${p.value.password}${p.value.captcha}`).toString(),w.dispatch("user/login",p.value).then(h=>{var v;t.push({path:((v=l.query)==null?void 0:v.redirect)||"/"})})};return L(),(h,v)=>(s(),b("div",Li,[Di,y("form",Ri,[oe(y("input",{"onUpdate:modelValue":v[0]||(v[0]=k=>S(p).username=k),type:"text",placeholder:"用户名",class:"input"},null,512),[[me,S(p).username]]),oe(y("input",{"onUpdate:modelValue":v[1]||(v[1]=k=>S(p).password=k),type:"password",placeholder:"密码",class:"input"},null,512),[[me,S(p).password]]),y("div",ji,[oe(y("input",{"onUpdate:modelValue":v[2]||(v[2]=k=>S(p).captcha=k),type:"text",placeholder:"验证码",class:"input-captcha"},null,512),[[me,S(p).captcha]]),y("img",{class:"captcha-img",src:a.value+"/user/captcha?ts="+S(o),title:"点击刷新",onClick:n},null,8,Mi)]),y("div",{class:U({input:!0,button:!0,"no-ready":!d.value}),onClick:m},"登录",2),y("div",Ni,[y("div",null,O(i.value),1)]),y("div",Vi,[qi,(s(!0),b(E,null,$(Object.keys([]),k=>(s(),b("div",{key:k},O(k),1))),128))])])]))}}),Hi={name:"NotFoundPage"},ut=e=>(et("data-v-26068803"),e=e(),tt(),e),Fi={class:"not-found"},Gi=ut(()=>y("svg",{width:"380px",height:"500px",viewBox:"0 0 837 1045",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:sketch":"http://www.bohemiancoding.com/sketch/ns"},[y("g",{id:"Page-1",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd","sketch:type":"MSPage"},[y("path",{id:"Polygon-1",d:"M353,9 L626.664028,170 L626.664028,487 L353,642 L79.3359724,487 L79.3359724,170 L353,9 Z",stroke:"#007FB2","stroke-width":"6","sketch:type":"MSShapeGroup"}),y("path",{id:"Polygon-2",d:"M78.5,529 L147,569.186414 L147,648.311216 L78.5,687 L10,648.311216 L10,569.186414 L78.5,529 Z",stroke:"#EF4A5B","stroke-width":"6","sketch:type":"MSShapeGroup"}),y("path",{id:"Polygon-3",d:"M773,186 L827,217.538705 L827,279.636651 L773,310 L719,279.636651 L719,217.538705 L773,186 Z",stroke:"#795D9C","stroke-width":"6","sketch:type":"MSShapeGroup"}),y("path",{id:"Polygon-4",d:"M639,529 L773,607.846761 L773,763.091627 L639,839 L505,763.091627 L505,607.846761 L639,529 Z",stroke:"#F2773F","stroke-width":"6","sketch:type":"MSShapeGroup"}),y("path",{id:"Polygon-5",d:"M281,801 L383,861.025276 L383,979.21169 L281,1037 L179,979.21169 L179,861.025276 L281,801 Z",stroke:"#36B455","stroke-width":"6","sketch:type":"MSShapeGroup"})])],-1)),Ji=ut(()=>y("div",{class:"message-box"},[y("h1",null,"404"),y("p",null,"Page not found"),y("div",{class:"buttons-con"},[y("div",{class:"action-link-wrap"},[y("a",{href:"",class:"link-button"},"Go to Home Page")])])],-1)),Ki=[Gi,Ji];function zi(e,t,l,i,a,o){return s(),b("div",Fi,Ki)}const Zi=T(Hi,[["render",zi],["__scopeId","data-v-26068803"]]),Wi=[{path:"/",component:dt,redirect:"/dashboard",name:"Root",meta:{menuType:1},children:[{path:"dashboard",name:"Dashboard",component:Gl,meta:{title:"Dashboard",icon:"el-icon-help",menuType:2,keepAlive:!0}}]},{path:"/login",component:Ui,meta:{title:"用户登录",menuType:0},hidden:!0},{path:"/404",component:Zi,meta:{menuType:0},hidden:!0}],J=zt({history:Zt(),routes:Wi});ve.configure({showSpinner:!1});function Xi(e){e.beforeEach((t,l,i)=>{ve.start(),t.preHash=location.hash.replace("#",""),i()}),e.afterEach(t=>{t.matched.length>0&&w.commit("user/updateState",{key:"path",value:t.matched[t.matched.length-1].path.replace("(\\d+)","")}),ve.done()})}function Yi(){return w.state.user.isLodeRemoteRoutes}function mt(){return w.state.settings.whiteRoutes||[]}function Qi(){return w.state.user.token}function eo(e){e.beforeEach(async(t,l,i)=>{var a,o;if(mt().indexOf(t.path)!==-1){i();return}if(Qi()){(a=t.query)!=null&&a.redirect?i((o=t.query)==null?void 0:o.redirect):i();return}const n=t.query.redirect||t.path,d=Pi();if(!d){i(`/login?redirect=${n}`);return}const p=d.flag();if(p&&await w.dispatch("user/login",f.isObject(p)?p:{ticket:p})){i();return}d.jumpToLoginPage(i,`/login?redirect=${n}`)})}const to={},lo={class:"loading preloader"},ao=y("div",{class:"preloader-inner"},null,-1),io=[ao];function oo(e,t){return s(),b("div",lo,io)}const ht=T(to,[["render",oo]]),no={name:"VNotice",props:{dataApi:{type:String,default:""},notice:{type:Object,default:()=>{}}},data(){return{noticeProps:{},hasNotice:!1}},mounted(){if(console.log("dataApi",!!this.$props.dataApi),this.$props.dataApi){this.$http.get(this.$props.dataApi).then(({data:e})=>{this.noticeProps=e,this.hasNotice=!!e});return}else this.hasNotice=Object.keys(this.$props.notice).length>0,this.noticeProps=this.$props.notice}};function so(e,t,l,i,a,o){const n=Ie;return s(),b("div",null,[a.hasNotice?(s(),u(n,H(q({key:0},a.noticeProps)),null,16)):I("",!0)])}const ft=T(no,[["render",so]]),ro=N({components:{VLoading:ht,VNotice:ft},props:{schemaHandler:{type:Function,default:function(e,t){return e}},schemaApi:{type:String,default:""}},data(){return{loading:!0,haveNotice:!1,notice:{},noticeApi:"",schema:{},owners:[],serviceOffLine:!1}},computed:{env(){return this.$store.state.user.env},setting(){return this.$store.state.settings}},beforeCreate(){const e=this.$route.path.split("/").filter(a=>a),t=e.length>1?e.slice(0,e.length-1).join("/"):e[0],l="/schema"+this.$route.meta.path,i={params:this.$route.params};this.$http.get(this.$props.schemaApi||l,i).then(({data:a})=>{this.loading=!1,Z(a)&&(a.notice!==void 0&&(this.haveNotice=!0,we(a.notice)?this.notice={title:a.notice}:Z(a.notice)&&(this.notice=a.notice,this.noticeApi=a.notice.noticeApi),delete a.notice),this.owners=a.ownerNames||[],this.serviceOffLine=a.serviceOffLine||!1),this.schema=this.$props.schemaHandler(a,t),w.commit("app/SET_PAGE_JSON_SCHEMA",{page:this.$route.path,json:this.schema})})}}),po=["innerHTML"];function co(e,t,l,i,a,o){const n=Ie,d=ft,p=ht;return s(),b(E,null,[e.owners.length>0?(s(),u(n,{key:0,title:`该页面功能对应开发: [ ${e.owners.join(", ")} ] 有问题可直接企微反馈`,type:"info",style:{margin:"0 0 20px 0"},closable:!1},null,8,["title"])):I("",!0),e.env==="prod"&&e.serviceOffLine?(s(),b("div",{key:1,class:"offline-notice",innerHTML:e.serviceOffLine===!0?e.setting.serviceOffLineNotice:e.serviceOffLine},null,8,po)):(s(),b(E,{key:2},[e.haveNotice?(s(),u(d,{key:0,notice:e.notice,style:{margin:"0 0 20px 0"},"data-api":e.noticeApi},null,8,["notice","data-api"])):I("",!0),e.loading?(s(),u(p,{key:1})):ee(e.$slots,"default",H(q({key:2},e.schema)),void 0,!0)],64))],64)}const ae=T(ro,[["render",co],["__scopeId","data-v-4965a709"]]),bt={__name:"table",setup(e){const t=(l,i)=>{if(l.orderBy){const o={prop:l.orderBy.field,order:l.orderBy.mod==="desc"?"descending":"ascending"};l.tableProps=f.merge(l.tableProps,{defaultSort:o})}const a=Object.keys(te.props);return Object.keys(l).forEach(o=>{a.indexOf(o)===-1&&delete l[o]}),l.listApi===void 0&&(l.listApi=`/${i}/list`),l};return(l,i)=>(s(),u(ae,{"schema-handler":t},{default:r(a=>[c(S(te),H(X(a)),null,16)]),_:1}))}},_e={__name:"form",setup(e){const t=pe(),l=(i,a)=>{const o=Object.keys(G.props);return Object.keys(i).forEach(n=>{if(o.indexOf(n)===-1){delete i[n];return}/.*Api$/.test(n)&&(i[n]=ie(i[n],t.params))}),i.saveApi===void 0&&(t.params.id!==void 0?(i.saveApi=`/${a}/update/${t.params.id}`,i.getApi||(i.getApi=`/${a}/get/${t.params.id}`)):(delete i.getApi,i.saveApi=`/${a}/create`)),i=f.merge({saveApi:a+"/save",afterSubmit:"goback",afterReset:"goback",mod:t.params.id?"edit":"create"},i),i};return(i,a)=>(s(),u(ae,{"schema-handler":l},{default:r(o=>[c(S(G),H(X(o)),null,16)]),_:1}))}},uo=N({name:"VTree",components:{VForm:G},props:{treeApi:{type:String,default:"",require:!0},getApi:{type:String,default:"",require:!0},saveApi:{type:String,default:"",require:!0},createApi:{type:String,default:"",require:!0},deleteApi:{type:String,default:"",require:!0},formItems:{type:Array,default:()=>[]},treeProps:{type:Object,default:()=>{}},maxDepth:{type:Number,default:3},props:{type:Object,default:()=>{}}},data(){return{type:0,treeData:[],formData:{},localTreeProps:f.merge({"default-expand-all":!0,"expand-on-click-node":!1,props:{children:"children",label:"label"}},this.$props.treeProps),formkey:0,tablekey:0,menuOptions:{}}},computed:{formType(){return["","新建","编辑"][this.type]},formProps(){let e=ie(this.$props.saveApi,this.formData);return this.type===1&&(e=this.$props.createApi),{saveApi:e,getApi:this.$props.getApi,formItems:this.$props.formItems}}},created(){this.loadTree()},methods:{loadTree(){this.$http.request({method:"GET",url:this.$props.treeApi}).then(({data:e})=>{this.treeData=e})},onclick(e){this.type=2,this.formData=e,this.formkey++},append(e,t){var l,i;this.type=1;const a={pid:e.id,[((l=this.$props.props)==null?void 0:l.levelKey)??"level"]:t.level+1,...Bt((i=this.$props.props)==null?void 0:i.effectData,e)};console.log(111,a),e.children||(e.children=[]),this.formData=a,this.formkey++,e.children.push(a),this.treeData=[...this.treeData]},canAppend(e,t){return e[this.localTreeProps.props.label]?t.level<this.$props.maxDepth:!1},appendNew(){var e;this.type=1;const t={pid:0,[((e=this.$props.props)==null?void 0:e.levelKey)??"level"]:1};this.formData=t,this.formkey++,this.tablekey++,this.treeData=[...this.treeData,t]},remove(e){this.$http.request({method:"DELETE",url:ie(this.$props.deleteApi,e)}).then(({code:t})=>{t!==0?this.$message.error("操作失败"):this.loadTree()})},submit(){setTimeout(()=>{this.loadTree(),this.formData={},this.tablekey++,this.type=0},200)},allowDrap(e){return!0},allowDrop(e,t,l){return console.log(l),l==="inner"},handleDragEnd(e,t,l,i){const a=e.data;a.pid=t.data.id,this.$http.request({method:"POST",url:ie(this.$props.saveApi,a),data:a}).then(({code:o})=>{o!==0&&this.$message.error("操作失败")})}}}),mo={class:"card-header"},ho=y("span",null,"列表",-1),fo={class:"tree-action"},bo={key:0},yo={key:1,style:{color:"#E6A23C"}},vo={class:"card-header"};function go(e,t,l,i,a,o){const n=se,d=Jt,p=re,m=le,h=g("v-form"),v=W;return s(),u(v,{class:"tree-box",gutter:20},{default:r(()=>[c(m,{span:8,class:"tree-tree"},{default:r(()=>[c(p,{shadow:"never"},{header:r(()=>[y("div",mo,[ho,c(n,{type:"text",onClick:t[0]||(t[0]=()=>e.appendNew())},{default:r(()=>[_("添加")]),_:1})])]),default:r(()=>[(e.treeData||[]).length>0?(s(),u(d,q({key:0,style:{height:"100vh"},data:e.treeData,"node-key":"id"},e.localTreeProps,{draggable:"","allow-drag":e.allowDrap,"allow-drop":e.allowDrop,onNodeDragEnd:e.handleDragEnd}),{default:r(({node:k,data:x})=>[y("span",fo,[x[e.localTreeProps.props.label]?(s(),b("span",bo,O(x[e.localTreeProps.props.label]),1)):(s(),b("span",yo,"请在右侧表单中修改 --> ")),y("span",null,[x[e.localTreeProps.props.label]?(s(),u(n,{key:0,class:"button",type:"text",onClick:()=>e.onclick(x)},{default:r(()=>[_("编辑")]),_:2},1032,["onClick"])):I("",!0),e.canAppend(x,k)?(s(),u(n,{key:1,class:"button",type:"text",onClick:()=>e.append(x,k)},{default:r(()=>[_("添加")]),_:2},1032,["onClick"])):I("",!0),x.children===void 0||x.children.length===0?(s(),u(n,{key:2,class:"button",type:"text",onClick:()=>e.remove(x)},{default:r(()=>[_("删除")]),_:2},1032,["onClick"])):I("",!0)])])]),_:1},16,["data","allow-drag","allow-drop","onNodeDragEnd"])):I("",!0)]),_:1})]),_:1}),c(m,{span:16,class:"tree-form"},{default:r(()=>[e.type?(s(),u(p,{key:0,shadow:"never"},{header:r(()=>[y("div",vo,[y("span",null,O(e.formType),1)])]),default:r(()=>[(s(),u(h,q({key:e.formkey,modelValue:e.formData,"onUpdate:modelValue":t[1]||(t[1]=k=>e.formData=k)},e.formProps,{onSubmit:e.submit}),null,16,["modelValue","onSubmit"]))]),_:1})):I("",!0)]),_:1})]),_:1})}const Ve=T(uo,[["render",go]]),ko={__name:"tree",setup(e){const t=(l,i)=>{const a=Object.keys(Ve.props);return Object.keys(l).forEach(o=>{a.indexOf(o)===-1&&delete l[o]}),l};return(l,i)=>(s(),u(ae,{"schema-handler":t},{default:r(a=>[c(Ve,H(X(a)),null,16)]),_:1}))}},be={__name:"container",setup(e){const t=L(0);return Yt(()=>{t.value++}),(l,i)=>{const a=g("router-view");return s(),u(a)}}},_o={title:{text:""},tooltip:{trigger:"axis"},grid:{left:"2%",right:"2%",bottom:"5%",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},legend:{data:[]},xAxis:{type:"category"},yAxis:{type:"value"},series:[]};function So(e,t,l){if(l.length===0)return{};let i=f.merge({},_o);if(i.title.text=e,we(t)){const a=[],o=Object.keys(l[0]);let n=o[0],d=o.filter((m,h)=>h>0),p=t;if(t.indexOf(":")>-1){const m=t.split(":"),h=m[1].split(",");p=m[0],n=h[0],d=h.filter((v,k)=>k>0)}d.forEach(m=>{const h=[];l.forEach(v=>{h.push(v[m])}),i.series.push({name:m,type:p,smooth:!0,data:h}),i.legend.data.push(m)}),l.forEach(m=>{a.push(m[n])}),i.xAxis.data=a}return Z(t)&&(i=f.merge(i,t)),console.log(111,i),i}const wo=N({name:"NumberPanel",props:{dataList:{type:Array,default:e=>[]}},data(){return{}}}),xo={class:"number-panel-title"},Eo={class:"number"},Io={class:"name"};function To(e,t,l,i,a,o){return s(!0),b(E,null,$(e.dataList,(n,d)=>(s(),b("span",{key:d},[y("div",xo,[(s(!0),b(E,null,$(Object.keys(n),(p,m)=>(s(),b("div",{key:m,class:"title-inner"},[y("p",Eo,O(n[p]),1),y("p",Io,O(p),1)]))),128))])]))),128)}const Bo=T(wo,[["render",To],["__scopeId","data-v-cc0d8293"]]),Co={components:{Chart:ll,Md:ol,Json:Oe,Table:te,Number:Bo,Html:""},props:{option:{type:Object,default:()=>{}}},setup(e){const t=()=>e.option.chart==="num"?"number":e.option.type;return{compprops:l=>{const i=t();if(i==="number")return{dataList:l.data};if(i==="chart")return{options:So(l.id,l.chart,l.data)};if(i==="md")return{source:l.data};if(i==="table"){if(!Ge(l.data))return{showPagination:!1};const a=[];return l.data[0]&&Object.keys(l.data[0]).forEach((o,n)=>{a.push({field:o,label:o})}),{headers:a,list:l.data,showPagination:!1}}return{}},comptype:t}}};function Oo(e,t,l,i,a,o){const n=re,d=dl("resize");return oe((s(),u(n,{shadow:"never",class:"part"},{default:r(()=>[(s(),u(lt(i.comptype()),H(X(i.compprops(l.option))),null,16))]),_:1})),[[d,!0]])}const $o=T(Co,[["render",Oo],["__scopeId","data-v-a5a65cc1"]]),Ao=N({__name:"index",props:{filter:{type:Array,default:()=>[]},dataPart:{type:Array,default:()=>[]}},setup(e){const t=e,l=useRoute();rl(()=>{});const i=L({});Qe(()=>{var h;(h=t.filter)==null||h.forEach(v=>{v.default!==null&&(i.value[v.field]=v.default)})});const a={inline:!0,labelPosition:"right",labelWidth:"auto",submitButton:{text:"查询"},cancelButton:{text:"重置"}},o=L(1),n=L(t.filter),d=L(t.dataPart),p=D(()=>{let h=l.params.id;if(!h){const v=l.path.split("/");h=v[v.length-1]}return"/focusbi_report/view/"+h}),m=h=>{Xo.get(p.value,{params:h}).then(({data:v})=>{n.value=v.filter,d.value=v.dataPart,o.value++})};return(h,v)=>{const k=re,x=le,F=Ie,V=W;return s(),u(V,null,{default:r(()=>[S(n).length>0?(s(),u(x,{key:0,span:24},{default:r(()=>[c(k,{shadow:"never",class:"part-filter"},{default:r(()=>[c(S(G),{modelValue:S(i),"onUpdate:modelValue":v[0]||(v[0]=C=>bl(i)?i.value=C:null),"form-items":S(n),options:a,onSubmit:m},null,8,["modelValue","form-items"])]),_:1})]),_:1})):I("",!0),c(x,{span:24},{default:r(()=>[c(V,{gutter:20},{default:r(()=>[(s(!0),b(E,null,$(S(d),(C,z)=>(s(),u(x,{key:z,span:C.col||24},{default:r(()=>[C.errMsg?(s(),u(F,{key:1,title:C.id+" 片段执行出错",type:"error"},{default:r(()=>[_(O(C.errMsg),1)]),_:2},1032,["title"])):(s(),u($o,{key:S(o),option:C},null,8,["option"]))]),_:2},1032,["span"]))),128))]),_:1})]),_:1})]),_:1})}}}),Po={__name:"report",setup(e){const t=useRoute(),l=D(()=>{let i=t.params.id;if(!i){const a=t.path.split("/");i=a[a.length-1]}return"/focusbi_report/view/"+i});return(i,a)=>(s(),u(ae,{"schema-api":S(l)},{default:r(o=>[c(Ao,H(X(o)),null,16)]),_:1},8,["schema-api"]))}},Lo=e=>c("div",null,[e.test]),Do={card:re,form:G,table:te,test:Lo,row:W,col:le},Ro={card:{type:"card",props:{class:"render-card",shadow:"never"}},form:{type:"form",props:{afterReset:""}},table:{type:"table",props:{syncUrl:!1}}};function jo(e){const t=Object.assign({},e),l=t.type.split(".").reverse(),i=t.span||24;delete t.span;let a={...t,type:l[0]};for(let o=1;o<l.length;o++)a={type:l[o],children:[a]};return a.span=i,De([a])}function De(e){const t={type:"row",props:{gutter:20,class:"render-row"},children:[]};return e.forEach(l=>{var i,a;let o=Object.assign({},l);if(Z((i=o.props)==null?void 0:i.style)){let p="";Object.keys((a=o.props)==null?void 0:a.style).forEach(m=>{var h;p+=m+":"+((h=o.props)==null?void 0:h.style[m])+";"}),o.props.style=p}const n={span:o.span??24,class:"render-col"};if(delete o.span,o.type.indexOf(".")>0){t.children.push({type:"col",props:n,children:jo(o)});return}o=f.merge({props:{}},Ro[o.type]||{},o);const d=yt(o.children);d.length&&(o.children=De(d)),t.children.push({type:"col",props:n,children:[o]})}),[t]}function yt(e){return Ge(e)?e:Z(e)?[e]:[]}let Se={};const vt=e=>{const t=Do[e.type]||Se[e.type]||e.type;return cl(t,e.props,{default:()=>yt(e.children).map(l=>vt(l))})},Mo=e=>(Object.keys(Se).length===0&&(Se=pl().appContext.components),De(Object.values(e.schema)).map(t=>vt(t))),No={__name:"custom",setup(e){const t=L([]),l=(i,a)=>(t.value=yl(i),i);return(i,a)=>(s(),u(ae,{"schema-handler":l},{default:r(()=>[c(S(Mo),{schema:S(t)},null,8,["schema"])]),_:1}))}};let Q={};function Ln(e){Q=e}const Vo=e=>{const t=l=>{const i="./views/"+l+".vue";return Q&&Q[i]&&Q[i].default?Q[i].default:(console.error(`自定义组件不存在 ${e.name} ${e.view}`),be)};if(e.path==="#")return be;switch(e.page_type){case R.list:return bt;case R.form:return _e;case R.custom:case R.localComp:return t(e.view||"");case R.tree:return ko;case R.report:return Po;case R.customSchema:return No}return be};function qo(e){let t=e.path;return e.type===P.menu&&e.page_type===R.entity&&(t="#"),t.indexOf(":id")>-1&&t.indexOf(":id")+3===t.length&&(t=t.replace(":id",":id(\\d+)")),t==="#"?"/"+e.id+"_DIR_"+e.name:t[0]!=="/"?"/"+t:t}function Uo(e){return(e.path+e.name).split("/").filter(t=>t).join("_")}const gt=e=>{const t=e.type!==P.page,l={path:qo(e),name:e.id+"_"+Uo(e)+"_"+e.path.replaceAll("/","_"),component:Vo(e),meta:{id:e.id,pageId:e.id,title:e.name,icon:e.icon,hidden:!t,path:e.path,menuType:e.type,keepAlive:!1},children:e.children?e.children.map(i=>gt(i)):[]};if(e.page_type===R.entity){const i=e.path+"/list",a=e.path+"/form",o=e.path+"/:id",n=[{path:i,name:e.name+"列表"+e.id,component:bt,meta:{id:e.id+99999,title:"列表",hidden:!0,menuType:P.hidden,keepAlive:!1,pageId:e.id,path:e.path}},{path:a,name:e.name+"新建"+e.id,component:_e,meta:{id:e.id+99999+1,title:"新建",hidden:!0,menuType:P.hidden,keepAlive:!1,pageId:e.id,path:e.path}},{path:o,name:e.name+"编辑"+e.id,component:_e,meta:{id:e.id+99999+2,title:"编辑",hidden:!0,menuType:P.hidden,keepAlive:!1,pageId:e.id,path:e.path}}];l.children=[...n,...l.children]}if(l.children&&l.children.length>0){let i=!0;if(l.children.forEach(a=>{a.meta&&!a.meta.hidden&&(i=!1)}),l.meta&&(l.meta.menuType=t?P.dir:P.hidden),i){l.meta&&(l.meta.menuType=P.menu);let a="/";for(let o=0;o<l.children.length;o++)if(l.children[o].path.indexOf("/:")===-1){a=l.children[o].path;break}l.redirect=a,l.path="/"+e.id+"_DIR"+l.redirect.replaceAll("/","_").toUpperCase()}}return l},Ho=e=>{const t=[];return e.forEach(l=>{const i={id:l.id,label:l.label,routes:[]};l.routes.forEach(a=>{i.routes.push(gt(a))}),t.push(i)}),t};function Fo(e){e.beforeEach(async(t,l,i)=>{if(mt().indexOf(t.path)!==-1){i();return}if(Yi()){i();return}await w.dispatch("user/info");const a=await w.dispatch("user/loadRemoteRoutes"),o=Ho(a);o.forEach(n=>{n.routes.forEach(d=>{e.addRoute({path:"/",component:dt,children:[d]})})}),e.addRoute({name:"404",path:"/:pathMatch(.*)*",redirect:"/404",hidden:!0}),w.commit("user/updateRemoteRouter",o),await e.replace(t),i()})}function Go(e){e.beforeEach(async(t,l,i)=>{var a;const o=[w.state.settings.title||""],n=t.matched.length;for(let d=n;d>n-3;d--){const p=t.matched[d-1];(a=p==null?void 0:p.meta)!=null&&a.title&&o.push(p.meta.title+"")}o.length>1&&(document.title=o.reverse().join("-")),i()}),e.afterEach(async(t,l,i)=>{Object.keys(t.meta).length>0&&await w.dispatch("app/setCurrentMeta",t.meta)})}function Jo(e){eo(e),Xi(e),Fo(e),Go(e)}Jo(J);function Ko(){return w.state.user.token}function qe(e){Nl({message:e,type:"error",duration:5*1e3,grouping:!0})}const zo={onFulfilled:function(e){var t;e.headers=e.headers||{};const l=Ko();return l&&(e.headers["X-Token"]=l),(t=J.currentRoute.value.meta)!=null&&t.path&&(e.headers["X-Path"]=J.currentRoute.value.meta.path),e}},Zo={onFulfilled(e){var t,l,i,a,o,n,d;if(!(((t=e.config)==null?void 0:t.notHoldApiErr)!==void 0&&((l=e.config)==null?void 0:l.notHoldApiErr)===!0)&&e.data.code!==0){const m=e.data.message||`接口请求错误 ${e.config.method}::${(i=e.config.url)==null?void 0:i.split("?")[0]}`;if(e.data.code===401){Me.alert("登录信息已过期或未登录, 是否跳转登录","操作提醒",{showClose:!1,confirmButtonText:"重新登录",showCancelButton:!0,cancelButtonText:"取消",callback:h=>{h==="confirm"&&(nt(),location.href=location.origin+location.pathname+location.hash.replace("#","#/?redirect="),location.reload())}});return}else qe(m);return Promise.reject(m)}let p=(o=(a=e.data)==null?void 0:a.data)==null?void 0:o._message_box;return p!==void 0&&(we(p)&&(p={message:(d=(n=e.data)==null?void 0:n.data)==null?void 0:d._message_box}),Me({title:"提示",type:"success",grouping:!0,...p})),e.data},onRejected(e){var t;return Te.isCancel(e)?Promise.reject(""):(qe(`${e.message} ${e.config.method}::${(t=e.config.url)==null?void 0:t.split("?")[0]}`),Promise.reject(e))}},Wo=[{request:ql,response:Ul},{request:zo,response:Zo}];function kt(e={}){const t=$e.axios||{},l=f.merge(t,e||{}),i=Te.create({...l});return Wo.forEach(a=>{i.interceptors.request.use(a.request.onFulfilled,a.request.onRejected),i.interceptors.response.use(a.response.onFulfilled,a.response.onRejected)}),i}const Xo=kt(),Yo={beforeMount(e,t){e.clickOutsideEvent=function(l){e===l.target||e.contains(l.target)||t.value(l,e)},document.body.addEventListener("click",e.clickOutsideEvent)},unmounted(e){document.body.removeEventListener("click",e.clickOutsideEvent)}},K=al(),Qo={mounted:(e,t)=>{e!==null&&(t.value,e.oncontextmenu=l=>{l.preventDefault(),l.stopPropagation(),l.cancelBubble=!0,t.value&&K.emit("right-click",{event:l,data:t.value})})}},en={mounted(e){}};function Ue(e,t){let l=e[`offset${t}`],i=e.offsetParent;for(;i;)l+=i[`offset${t}`],i=i.offsetParent;return l}const tn={mounted:(e,t)=>{if(e===null||!t.value.dev)return;let l=e;if(t.value.parent)for(let p=0;p<t.value.parent;p++)l.parentElement&&(l=l.parentElement);l.classList.add("devtool-hover");const i=document.createElement("i");i.className="devtool-item-wrapper",l.onmouseover=()=>{i.style.height=l.offsetHeight+30+"px",i.style.width=l.offsetWidth+30+"px",i.style.top=Ue(l,"Top")-15+"px",i.style.left=Ue(l,"Left")-15+"px"};const a=document.createElement("span");a.className="dev-action-edit",a.title="编辑";const o=document.createElement("i");o.className="iconfont ra-editor1",a.appendChild(o),a.onclick=p=>{K.emit("dev-action",{event:p,data:{type:"edit",devId:t.value.devId}})},i.appendChild(a);const n=document.createElement("span");n.className="dev-action-del",n.title="删除";const d=document.createElement("i");d.className="iconfont ra-cut",n.appendChild(d),n.onclick=p=>{K.emit("dev-action",{event:p,data:{type:"del",devId:t.value.devId}})},i.appendChild(n),l.insertBefore(i,l.firstChild)}},ln=Object.freeze(Object.defineProperty({__proto__:null,devtool:tn,outClick:Yo,resize:en,rightClick:Qo},Symbol.toStringTag,{value:"Module"}));let ye;function Dn(e){const t=f.merge($e,e),l=ul(gl),i=cn(t),a=t.plugins||[];a.unshift(i),a.forEach(o=>{pn(l,o)}),t!=null&&t.mock&&Cl(),ye=kt(t.axios),w.dispatch("setHttp",ye).then(),w.dispatch("settings/updateSettings",e==null?void 0:e.settings).then(),w.dispatch("app/setBaseAPI",t==null?void 0:t.axios.baseURL).then(),l.config.globalProperties.$http=ye,l.config.globalProperties.$router=J,window.App=l,window.OmsOptions=t,tl(()=>({"X-Token":Pe()})),J.isReady().then(()=>l.mount("#app"))}function an(e,t={}){Object.keys(t).forEach(l=>{e.component(l,t[l])})}function on(e=[]){e.forEach(t=>{J.addRoute(t)}),w.commit("user/setCustomRoutes",e)}function nn(e,t){t.forEach(l=>{Z(l)&&(l=[l]),e.use(...l)})}function sn(e,t={}){Object.keys(t).forEach(l=>{e.directive(l,t[l])})}function rn(e={}){const t=["app","settings","user"];Object.keys(e).forEach(l=>{if(t.indexOf(l)!==-1){console.warn(`storeModule name [${l}] is use by base, please change it!`);return}w.registerModule(l,e[l])})}function pn(e,t){an(e,t.components||{}),on(t.routes||[]),nn(e,t.use||[]),sn(e,t.directives||{}),rn(t.storeModules||{}),it(t.mockApis||[])}function cn(e){var t;return{components:{VIcon:el},directives:ln,use:[w,J,[Ot,{locale:Je,...(t=e.settings)==null?void 0:t.ElementPlus}]]}}export{Ln as $,Dn as C,Pn as S,dt as b};
